@model List<Azimuth.Shared.Dto.PlaylistData>

@Html.DisplayFor(x => x);
    
<script type="text/javascript" src="../../Scripts/jquery-1.10.2.js"></script>

<script type="text/javascript">

    $(document).ready(function() {
        $('#tracksArea').hide(); 
    });

    $('.playlist-plated').click(function () {
        $('#playlistsArea').hide();
        $('#playlist-spinner').show();
        var $currentPlaylist = $(this);
        var playlistId = $currentPlaylist.find('.playlistId').val();
        $.ajax({
            url: '@Url.Action("_PlaylistTracks", "PublicPlaylists")?playlistId=' + playlistId +
                "&playlistName=" + $currentPlaylist.find('.playlistName').text() +
                "&isLiked=" + $currentPlaylist.find('.isLiked').val() +
                "&isFavourited=" + $currentPlaylist.find('.isFavourited').val(),
            type: 'GET',
            success: function(data) {
                $(data).appendTo($('#tracksArea'));
                $.ajax({
                    url: 'api/playlists/raiselistened?id=' + playlistId,
                    type: 'POST'
                });
            }
        });
    });
</script>

<script type="text/javascript">
    var self = this;

    this._setNewImage = function ($playlist, id) {
        $.ajax({
            url: '/api/playlists/image/' + id,
            success: function (image) {
                var $logo = $playlist;
                $logo.fadeOut(200, function () {
                    if (image != "") {
                        $logo.css({
                            "background-image": 'url(' + image + ')'
                        });
                    } else {
                        $logo.css({
                            "background-image": 'url(http://cdns2.freepik.com/free-photo/music-album_318-1832.jpg)'
                        });
                    }
                });
                $logo.fadeIn(200);
            }
        });
    };

    $('.playlist-plated').each(function() {
        self._setNewImage($(this), $(this).find('.playlistId').val());
    });
</script>